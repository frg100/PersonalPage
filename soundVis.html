<html>

<head>
  <meta charset='UTF-8'>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Main CSS -->
  <link href='./assets/css/sound-vis.css' rel='stylesheet'>

  <!-- Font Awesome CSS -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  <!-- Scripts -->
  <script>
    function authenticate(){
      console.log("Authenticating...");
      const clientId = "689648aff5394a4b8eee2c43fd508311";
      const redirectUri = "https:%2F%2Fweb.stanford.edu%2F~frg100%2FsoundVis";
      const scopes = "user-read-private%20user-read-email";
      const authUrl = `https://accounts.spotify.com/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&scope=${scopes}&response_type=token&state=123`;
      console.log(authUrl);
      window.open(authUrl);
    }

    window.addEventListener("message", function(event) {
        console.log(event.data);
        var hash = JSON.parse(event.data);
        if (hash.type == 'access_token') {
            console.log(hash.access_token);
      }
    }, false);
    
  </script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"/>

  <title> SoundVis </title>

</head>

<body>
 <div>
    <div class="login">
     <h1>First, log in to spotify</h1>
     <button class="btn btn-primary" onclick=authenticate>Log in</button>
    </div>
    <div class="logged-in">
    </div>
 </div>

 <script id="loggedin-template" type="text/x-handlebars-template">
    <h1>Logged in as </h1>
    <img id="avatar" width="200" src="" />
    <dl>
     <dt>Display name</dt><dd></dd>
     <dt>Username</dt><dd></dd>
     <dt>Email</dt><dd></dd>
     <dt>Spotify URI</dt><dd><a href=""></a></dd>
     <dt>Link</dt><dd><a href=""></a></dd>
     <dt>Profile Image</dt><dd></dd>
    </dl>
    <p><a href="/">Log in again</a></p>
 </script>
</body>
</html>